/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements. 
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */!function(e){function t(t){for(var n,a,c=t[0],o=t[1],r=0,l=[];r<c.length;r++)a=c[r],Object.prototype.hasOwnProperty.call(i,a)&&i[a]&&l.push(i[a][0]),i[a]=0;for(n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n]);for(s&&s(t);l.length;)l.shift()()}var n={},i={0:0};function a(t){if(n[t])return n[t].exports;var i=n[t]={i:t,l:!1,exports:{}};return e[t].call(i.exports,i,i.exports,a),i.l=!0,i.exports}a.e=function(e){var t=[],n=i[e];if(0!==n)if(n)t.push(n[2]);else{var c=new Promise((function(t,a){n=i[e]=[t,a]}));t.push(n[2]=c);var o,r=document.createElement("script");r.charset="utf-8",r.timeout=120,a.nc&&r.setAttribute("nonce",a.nc),r.src=function(e){return a.p+"indexLifecycleManagement.chunk."+e+".js"}(e);var s=new Error;o=function(t){r.onerror=r.onload=null,clearTimeout(l);var n=i[e];if(0!==n){if(n){var a=t&&("load"===t.type?"missing":t.type),c=t&&t.target&&t.target.src;s.message="Loading chunk "+e+" failed.\n("+a+": "+c+")",s.name="ChunkLoadError",s.type=a,s.request=c,n[1](s)}i[e]=void 0}};var l=setTimeout((function(){o({type:"timeout",target:r})}),12e4);r.onerror=r.onload=o,document.head.appendChild(r)}return Promise.all(t)},a.m=e,a.c=n,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)a.d(n,i,function(t){return e[t]}.bind(null,i));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="",a.oe=function(e){throw console.error(e),e};var c=window.indexLifecycleManagement_bundle_jsonpfunction=window.indexLifecycleManagement_bundle_jsonpfunction||[],o=c.push.bind(c);c.push=t,c=c.slice();for(var r=0;r<c.length;r++)t(c[r]);var s=o;a(a.s=22)}([function(e,t){e.exports=__kbnSharedDeps__.EmotionReact},function(e,t){e.exports=__kbnSharedDeps__.ElasticEui},function(e,t){e.exports=__kbnSharedDeps__.KbnI18n},function(e,t){e.exports=__kbnSharedDeps__.KbnI18nReact},function(e,t,n){e.exports=n(21)(2)},function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"d",(function(){return r})),n.d(t,"c",(function(){return s})),n.d(t,"b",(function(){return l})),n.d(t,"e",(function(){return d}));var i=n(16);let a;function c(e){a=e}function o(e){const t="/api/index_lifecycle_management";return e?`${t}/${e}`:t}function r(e,t,n){return a.post(o(e),{body:JSON.stringify(t),query:n})}function s(e,t){return a.get(o(e),{query:t})}function l(e){return a.delete(o(e))}const d=e=>Object(i.useRequest)(a,{...e,path:o(e.path)})},function(e,t){e.exports=__kbnSharedDeps__.React},function(e,t,n){"use strict";n.d(t,"n",(function(){return i})),n.d(t,"p",(function(){return a})),n.d(t,"o",(function(){return c})),n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return r})),n.d(t,"j",(function(){return s})),n.d(t,"m",(function(){return l})),n.d(t,"k",(function(){return d})),n.d(t,"h",(function(){return u})),n.d(t,"i",(function(){return f})),n.d(t,"l",(function(){return m})),n.d(t,"c",(function(){return p})),n.d(t,"e",(function(){return x})),n.d(t,"d",(function(){return g})),n.d(t,"g",(function(){return y})),n.d(t,"f",(function(){return b}));const i={hot:"100",warm:"50",cold:"0",frozen:"0"},a={max_age:"30d",max_primary_shard_size:"50gb"},c={name:"",phases:{hot:{actions:{rollover:a}}}},o="index_lifecycle_management",r="app_load",s="policy_create",l="policy_update",d="policy_delete",u="policy_attach_index",f="policy_attach_index_template",m="policy_detach_index",p="config_cold_phase",x="config_warm_phase",g="config_set_priority",y="index_retry_step",b="edit_click"},function(e,t,n){"use strict";let i,a;function c(e,t){i=e,a=t}n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return c}))},function(e,t,n){"use strict";n.d(t,"c",(function(){return a})),n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return o}));var i=n(7);let a=(e,t)=>{};function c(e){e&&(a=e.reportUiCounter.bind(e,i.b))}function o(e){return[{metric:i.c,isTracked:()=>Boolean(e.cold)},{metric:i.e,isTracked:()=>Boolean(e.warm)},{metric:i.d,isTracked:()=>{const t=e.hot&&e.hot.actions.set_priority&&e.hot.actions.set_priority.priority!==parseInt(i.n.hot,10),n=e.warm&&e.warm.actions.set_priority&&e.warm.actions.set_priority.priority!==parseInt(i.n.warm,10),a=e.cold&&e.cold.actions.set_priority&&e.cold.actions.set_priority.priority!==parseInt(i.n.cold,10);return t||n||a}}].reduce(((e,{metric:t,isTracked:n})=>(n()&&e.push(t),e)),[])}},function(e,t){e.exports=__kbnSharedDeps__.Lodash},function(e,t,n){"use strict";n.d(t,"j",(function(){return r})),n.d(t,"i",(function(){return s})),n.d(t,"h",(function(){return l})),n.d(t,"d",(function(){return d})),n.d(t,"k",(function(){return u})),n.d(t,"g",(function(){return f})),n.d(t,"c",(function(){return m})),n.d(t,"f",(function(){return p})),n.d(t,"e",(function(){return x})),n.d(t,"a",(function(){return g})),n.d(t,"b",(function(){return y})),n.d(t,"l",(function(){return b})),n.d(t,"m",(function(){return h}));var i=n(14),a=n(7),c=n(9),o=n(5);const r=()=>Object(o.e)({path:"nodes/list",method:"get",initialData:{nodesByAttributes:{},nodesByRoles:{}}}),s=e=>Object(o.e)({path:`nodes/${e}/details`,method:"get"}),l=(e=!1)=>Object(o.e)({path:"templates",query:{legacy:e},method:"get",initialData:[]});async function d(){return await Object(o.c)("policies")}const u=()=>Object(o.e)({path:"policies",method:"get"});async function f(e){return await Object(o.d)("policies",e)}async function m(e){const t=await Object(o.b)(`policies/${encodeURIComponent(e)}`);return Object(c.c)(i.METRIC_TYPE.COUNT,a.k),t}const p=async e=>{const t=await Object(o.d)("index/retry",{indexNames:e});return Object(c.c)(i.METRIC_TYPE.COUNT,a.g),t},x=async e=>{const t=await Object(o.d)("index/remove",{indexNames:e});return Object(c.c)(i.METRIC_TYPE.COUNT,a.l),t},g=async e=>{const t=await Object(o.d)("index/add",e);return Object(c.c)(i.METRIC_TYPE.COUNT,a.h),t},y=async(e,t=!1)=>{const n=await Object(o.d)("template",e,{legacy:t});return Object(c.c)(i.METRIC_TYPE.COUNT,a.i),n},b=()=>Object(o.e)({path:"snapshot_policies",method:"get",initialData:[]}),h=()=>Object(o.e)({path:"snapshot_repositories",method:"get"})},function(e,t,n){"use strict";n.d(t,"c",(function(){return a})),n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return c}));var i=n(2);const a=Object.freeze({warm:["data_warm","data_hot"],cold:["data_cold","data_warm","data_hot"],frozen:["data_frozen","data_cold","data_warm","data_hot"]}),c="enterprise",o={ID:"index_lifecycle_management",minimumLicenseType:"basic",TITLE:i.i18n.translate("xpack.indexLifecycleMgmt.appTitle",{defaultMessage:"Index Lifecycle Policies"})}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"e",(function(){return c})),n.d(t,"d",(function(){return o})),n.d(t,"c",(function(){return r})),n.d(t,"b",(function(){return s}));var i=n(17);const a={list:"/policies",edit:"/policies/edit/:policyName?",create:"/policies/edit"},c=e=>encodeURI(`/policies/edit/${encodeURIComponent(e)}`),o=()=>a.create,r=()=>a.list,s=(e,t)=>t("management",{path:`/data/index_management${Object(i.getIndexListUri)(`ilm.policy="${e}"`,!0)}`})},function(e,t){e.exports=__kbnSharedDeps__.KbnAnalytics},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n(8);function a(e,t){const n=function(e,t){if(e&&e.body){var n;const{error:i,statusCode:a,message:c,attributes:o}=e.body;return{title:t,text:`${a}: ${i}. ${null!=o&&null!==(n=o.causes)&&void 0!==n&&n.length?o.causes[o.causes.length-1]:c}`}}}(e,t);if(n)return i.c.addDanger(n);i.a.add(e,t)}},function(e,t,n){n.r(t);var i=__kbnBundles__.get("plugin/esUiShared/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(i))},function(e,t,n){n.r(t);var i=__kbnBundles__.get("plugin/indexManagement/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(i))},function(e,t){e.exports=__kbnSharedDeps__.RxjsOperators},function(e,t,n){n.r(t);var i=__kbnBundles__.get("plugin/home/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(i))},function(e,t){e.exports=__kbnSharedDeps__.MomentTimezone},function(e,t){e.exports=__kbnSharedDeps_npm__},function(e,t,n){n(23),__kbnBundles__.define("plugin/indexLifecycleManagement/public",n,24)},function(e,t,n){n.p=window.__kbnPublicPath__.indexLifecycleManagement},function(e,t,n){"use strict";n.r(t),n.d(t,"plugin",(function(){return C})),n.d(t,"ILM_LOCATOR_ID",(function(){return w}));var i=n(4),a=n.n(i),c=n(18),o=n(2),r=n(19),s=n(12),l=n(5),d=n(9),u=n(8);const f=function(){const e=[{text:o.i18n.translate("xpack.indexLifecycleMgmt.breadcrumb.homeLabel",{defaultMessage:"Index Lifecycle Management"}),href:"/policies"}];return{policies:e,editPolicy:[...e,{text:o.i18n.translate("xpack.indexLifecycleMgmt.breadcrumb.editPolicyLabel",{defaultMessage:"Edit policy"}),href:void 0}]}}();class breadcrumbs_BreadcrumbService{constructor(){a()(this,"setBreadcrumbsHandler",void 0)}setup(e){this.setBreadcrumbsHandler=e}setBreadcrumbs(e){if(!this.setBreadcrumbsHandler)throw new Error("BreadcrumbService#setup() must be called first!");const t=f[e]?[...f[e]]:[...f.policies],n=t.pop();t.push({...n,href:void 0}),this.setBreadcrumbsHandler(t)}}var m=n(6),p=n.n(m),x=n(10),g=n(1),y=n(11),b=n(20),h=n.n(b),M=n(3),_=n(13),j=n(0);class index_lifecycle_summary_IndexLifecycleSummary extends m.Component{constructor(e){super(e),a()(this,"toggleStackPopover",(()=>{this.setState({showStackPopover:!this.state.showStackPopover})})),a()(this,"closeStackPopover",(()=>{this.setState({showStackPopover:!1})})),a()(this,"togglePhaseExecutionPopover",(()=>{this.setState({showPhaseExecutionPopover:!this.state.showPhaseExecutionPopover})})),a()(this,"closePhaseExecutionPopover",(()=>{this.setState({showPhaseExecutionPopover:!1})})),this.state={showStackPopover:!1,showPhaseExecutionPopover:!1}}renderPhaseExecutionPopoverButton(e){const t=Object(j.jsx)(g.EuiLink,{onClick:this.togglePhaseExecutionPopover},Object(j.jsx)(M.FormattedMessage,{defaultMessage:"Show definition",id:"xpack.indexLifecycleMgmt.indexLifecycleMgmtSummary.showPhaseDefinitionButton"}));return Object(j.jsx)(m.Fragment,{key:"phaseDefinition"},Object(j.jsx)(g.EuiDescriptionListTitle,{key:"phaseDefinition_title"},Object(j.jsx)("strong",null,Object(j.jsx)(M.FormattedMessage,{defaultMessage:"Phase definition",id:"xpack.indexLifecycleMgmt.indexLifecycleMgmtSummary.showPhaseDefinitionDescriptionTitle"}))),Object(j.jsx)(g.EuiDescriptionListDescription,{key:"phaseDefinition_desc"},Object(j.jsx)(g.EuiPopover,{key:"phaseExecutionPopover",id:"phaseExecutionPopover",button:t,isOpen:this.state.showPhaseExecutionPopover,closePopover:this.closePhaseExecutionPopover},Object(j.jsx)(g.EuiPopoverTitle,null,Object(j.jsx)(M.FormattedMessage,{defaultMessage:"Phase definition",id:"xpack.indexLifecycleMgmt.indexLifecycleMgmtSummary.phaseDefinitionTitle"})),Object(j.jsx)(g.EuiCodeBlock,{lang:"json"},JSON.stringify(e.phase_execution,null,2)))))}buildRows(){const{index:{ilm:e}}=this.props,t=[["policy",o.i18n.translate("xpack.indexLifecycleMgmt.indexLifecycleMgmtSummary.headers.lifecyclePolicyHeader",{defaultMessage:"Lifecycle policy"})],["phase",o.i18n.translate("xpack.indexLifecycleMgmt.indexLifecycleMgmtSummary.headers.currentPhaseHeader",{defaultMessage:"Current phase"})],["action",o.i18n.translate("xpack.indexLifecycleMgmt.indexLifecycleMgmtSummary.headers.currentActionHeader",{defaultMessage:"Current action"})],["action_time_millis",o.i18n.translate("xpack.indexLifecycleMgmt.indexLifecycleMgmtSummary.headers.currentActionTimeHeader",{defaultMessage:"Current action time"})],["failed_step",o.i18n.translate("xpack.indexLifecycleMgmt.indexLifecycleMgmtSummary.headers.failedStepHeader",{defaultMessage:"Failed step"})]],n={left:[],right:[]};return t.forEach((([t,i],a)=>{const c=e[t];let o;o="action_time_millis"===t?h()(c).format("YYYY-MM-DD HH:mm:ss"):"policy"===t?Object(j.jsx)(g.EuiLink,{href:this.props.getUrlForApp("management",{path:`data/index_lifecycle_management/${Object(_.e)(c)}`})},c):c,o=o||"-";const r=Object(j.jsx)(m.Fragment,{key:String(a)},Object(j.jsx)(g.EuiDescriptionListTitle,{key:t},Object(j.jsx)("strong",null,i)),Object(j.jsx)(g.EuiDescriptionListDescription,{key:t+"_desc"},o));a%2==0?n.left.push(r):n.right.push(r)})),e.phase_execution&&n.right.push(this.renderPhaseExecutionPopoverButton(e)),n}render(){const{index:{ilm:e}}=this.props;if(!e.managed)return null;const{left:t,right:n}=this.buildRows();return Object(j.jsx)(p.a.Fragment,null,Object(j.jsx)(g.EuiTitle,{size:"s"},Object(j.jsx)("h3",null,Object(j.jsx)(M.FormattedMessage,{defaultMessage:"Index lifecycle management",id:"xpack.indexLifecycleMgmt.indexLifecycleMgmtSummary.summaryTitle"}))),e.step_info&&e.step_info.type?Object(j.jsx)(p.a.Fragment,null,Object(j.jsx)(g.EuiSpacer,{size:"s"}),Object(j.jsx)(g.EuiCallOut,{color:"danger",title:Object(j.jsx)(M.FormattedMessage,{defaultMessage:"Index lifecycle error",id:"xpack.indexLifecycleMgmt.indexLifecycleMgmtSummary.summaryErrorMessage"}),iconType:"cross"},e.step_info.type,": ",e.step_info.reason)):null,e.step_info&&e.step_info.message?Object(j.jsx)(p.a.Fragment,null,Object(j.jsx)(g.EuiSpacer,{size:"s"}),Object(j.jsx)(g.EuiCallOut,{color:"primary",title:Object(j.jsx)(M.FormattedMessage,{defaultMessage:"Action status",id:"xpack.indexLifecycleMgmt.indexLifecycleMgmtSummary.actionStatusTitle"})},e.step_info.message)):null,Object(j.jsx)(g.EuiSpacer,{size:"m"}),Object(j.jsx)(g.EuiFlexGroup,null,Object(j.jsx)(g.EuiFlexItem,null,Object(j.jsx)(g.EuiDescriptionList,{type:"column"},t)),Object(j.jsx)(g.EuiFlexItem,null,Object(j.jsx)(g.EuiDescriptionList,{type:"column"},n))))}}var O=n(15);class add_lifecycle_confirm_modal_AddLifecyclePolicyConfirmModal extends m.Component{constructor(e){super(e),a()(this,"addPolicy",(async()=>{const{indexName:e,closeModal:t,reloadIndices:n}=this.props,{selectedPolicyName:i,selectedAlias:a}=this.state;if(i)try{const c={indexName:e,policyName:i,alias:a};await Object(y.a)(c),t(),u.c.addSuccess(o.i18n.translate("xpack.indexLifecycleMgmt.indexManagementTable.addLifecyclePolicyConfirmModal.addPolicyToIndexSuccess",{defaultMessage:"Added policy {policyName} to index {indexName}.",values:{policyName:i,indexName:e}})),n()}catch(e){Object(O.a)(e,o.i18n.translate("xpack.indexLifecycleMgmt.indexManagementTable.addLifecyclePolicyConfirmModal.addPolicyToIndexError",{defaultMessage:"Error adding policy to index"}))}else this.setState({policyErrorMessage:o.i18n.translate("xpack.indexLifecycleMgmt.indexManagementTable.addLifecyclePolicyConfirmModal.noPolicySelectedErrorMessage",{defaultMessage:"You must select a policy."})})})),a()(this,"renderAliasFormElement",(e=>{const{selectedAlias:t}=this.state,{index:n}=this.props;if(!e||!Object(x.get)(e,"policy.phases.hot.actions.rollover"))return null;const{aliases:i}=n;if("none"===i)return Object(j.jsx)(m.Fragment,null,Object(j.jsx)(g.EuiSpacer,{size:"m"}),Object(j.jsx)(g.EuiCallOut,{style:{maxWidth:400},title:Object(j.jsx)(M.FormattedMessage,{id:"xpack.indexLifecycleMgmt.indexManagementTable.addLifecyclePolicyConfirmModal.indexHasNoAliasesWarningTitle",defaultMessage:"Index has no aliases"}),color:"warning"},Object(j.jsx)(M.FormattedMessage,{id:"xpack.indexLifecycleMgmt.indexManagementTable.addLifecyclePolicyConfirmModal.indexHasNoAliasesWarningMessage",defaultMessage:"Policy {policyName} is configured for rollover, but index {indexName} does not have an alias, which is required for rollover.",values:{policyName:null==e?void 0:e.name,indexName:n.name}})));const a=i.map((e=>({text:e,value:e})));return a.unshift({text:o.i18n.translate("xpack.indexLifecycleMgmt.indexManagementTable.addLifecyclePolicyConfirmModal.chooseAliasMessage",{defaultMessage:"Choose an alias"}),value:""}),Object(j.jsx)(g.EuiFormRow,{label:Object(j.jsx)(M.FormattedMessage,{id:"xpack.indexLifecycleMgmt.indexManagementTable.addLifecyclePolicyConfirmModal.chooseAliasLabel",defaultMessage:"Index rollover alias"})},Object(j.jsx)(g.EuiSelect,{options:a,value:t,onChange:e=>{this.setState({selectedAlias:e.target.value})}}))})),this.state={policies:[],selectedPolicyName:"",selectedAlias:""}}renderForm(){const{policies:e,selectedPolicyName:t,policyErrorMessage:n}=this.state,i=t?e.find((e=>e.name===t)):void 0,a=e.map((({name:e})=>({value:e,text:e})));return a.unshift({value:"",text:o.i18n.translate("xpack.indexLifecycleMgmt.indexManagementTable.addLifecyclePolicyConfirmModal.choosePolicyMessage",{defaultMessage:"Select a lifecycle policy"})}),Object(j.jsx)(g.EuiForm,null,Object(j.jsx)(g.EuiFormRow,{isInvalid:!!n,error:n,label:Object(j.jsx)(M.FormattedMessage,{id:"xpack.indexLifecycleMgmt.indexManagementTable.addLifecyclePolicyConfirmModal.choosePolicyLabel",defaultMessage:"Lifecycle policy"})},Object(j.jsx)(g.EuiSelect,{options:a,value:t,onChange:e=>{this.setState({policyErrorMessage:void 0,selectedPolicyName:e.target.value})}})),this.renderAliasFormElement(i))}async componentDidMount(){try{const e=await Object(y.d)();this.setState({policies:e})}catch(e){Object(O.a)(e,o.i18n.translate("xpack.indexLifecycleMgmt.indexManagementTable.addLifecyclePolicyConfirmModal.loadPolicyError",{defaultMessage:"Error loading policy list"})),this.props.closeModal()}}render(){const{policies:e}=this.state,{indexName:t,closeModal:n,getUrlForApp:i}=this.props,a=Object(j.jsx)(M.FormattedMessage,{id:"xpack.indexLifecycleMgmt.indexManagementTable.addLifecyclePolicyConfirmModal.modalTitle",defaultMessage:'Add lifecycle policy to "{indexName}"',values:{indexName:t}});return e.length?Object(j.jsx)(g.EuiConfirmModal,{title:a,onCancel:n,onConfirm:this.addPolicy,cancelButtonText:Object(j.jsx)(M.FormattedMessage,{id:"xpack.indexLifecycleMgmt.indexManagementTable.addLifecyclePolicyConfirmModal.cancelButtonText",defaultMessage:"Cancel"}),confirmButtonText:Object(j.jsx)(M.FormattedMessage,{id:"xpack.indexLifecycleMgmt.indexManagementTable.addLifecyclePolicyConfirmModal.addPolicyButtonText",defaultMessage:"Add policy"})},this.renderForm()):Object(j.jsx)(g.EuiModal,{onClose:n},Object(j.jsx)(g.EuiModalHeader,null,Object(j.jsx)(g.EuiModalHeaderTitle,null,a)),Object(j.jsx)(g.EuiModalBody,null,Object(j.jsx)(g.EuiCallOut,{style:{maxWidth:400},title:Object(j.jsx)(M.FormattedMessage,{id:"xpack.indexLifecycleMgmt.indexManagementTable.addLifecyclePolicyConfirmModal.noPoliciesWarningTitle",defaultMessage:"No index lifecycle policies defined"}),color:"warning"},Object(j.jsx)("p",null,Object(j.jsx)(g.EuiLink,{href:i("management",{path:"data/index_lifecycle_management/policies/edit"})},Object(j.jsx)(M.FormattedMessage,{id:"xpack.indexLifecycleMgmt.indexManagementTable.addLifecyclePolicyConfirmModal.defineLifecyclePolicyLinkText",defaultMessage:"Define lifecycle policy"}))))))}}class remove_lifecycle_confirm_modal_RemoveLifecyclePolicyConfirmModal extends m.Component{constructor(...e){super(...e),a()(this,"removePolicy",(async()=>{const{indexNames:e,closeModal:t,reloadIndices:n}=this.props;try{await Object(y.e)(e),t(),u.c.addSuccess(o.i18n.translate("xpack.indexLifecycleMgmt.indexManagementTable.removeLifecyclePolicyConfirmModal.removePolicySuccess",{defaultMessage:"Removed lifecycle policy from {count, plural, one {index} other {indices}}",values:{count:e.length}})),n()}catch(e){Object(O.a)(e,o.i18n.translate("xpack.indexLifecycleMgmt.indexManagementTable.removeLifecyclePolicyConfirmModal.removePolicyToIndexError",{defaultMessage:"Error removing policy"}))}}))}render(){const{closeModal:e,indexNames:t}=this.props;return Object(j.jsx)(g.EuiConfirmModal,{title:Object(j.jsx)(M.FormattedMessage,{id:"xpack.indexLifecycleMgmt.indexManagementTable.removeLifecyclePolicyConfirmModal.modalTitle",defaultMessage:"Remove lifecycle policy from {count, plural, one {index} other {indices}}",values:{count:t.length}}),onCancel:e,onConfirm:this.removePolicy,cancelButtonText:Object(j.jsx)(M.FormattedMessage,{id:"xpack.indexLifecycleMgmt.indexManagementTable.removeLifecyclePolicyConfirmModal.cancelButtonText",defaultMessage:"Cancel"}),buttonColor:"danger",confirmButtonText:Object(j.jsx)(M.FormattedMessage,{id:"xpack.indexLifecycleMgmt.indexManagementTable.removeLifecyclePolicyConfirmModal.removePolicyButtonText",defaultMessage:"Remove policy"})},Object(j.jsx)(m.Fragment,null,Object(j.jsx)("p",null,Object(j.jsx)(M.FormattedMessage,{id:"xpack.indexLifecycleMgmt.indexManagementTable.removeLifecyclePolicyConfirmModal.removeMessage",defaultMessage:"You are about to remove the index lifecycle policy from {count, plural, one {this index} other {these indices}}. This operation cannot be undone.",values:{count:t.length}})),Object(j.jsx)("ul",null,t.map((e=>Object(j.jsx)("li",{key:e},e))))))}}const L=({indices:e})=>{if(!Object(x.every)(e,(e=>e.ilm&&e.ilm.failed_step)))return null;const t=e.map((({name:e})=>e));return{requestMethod:y.f,icon:"play",indexNames:[t],buttonLabel:o.i18n.translate("xpack.indexLifecycleMgmt.retryIndexLifecycleActionButtonLabel",{defaultMessage:"Retry lifecycle step"}),successMessage:o.i18n.translate("xpack.indexLifecycleMgmt.retryIndexLifecycleAction.retriedLifecycleMessage",{defaultMessage:"Called retry lifecycle step for: {indexNames}",values:{indexNames:t.map((e=>`"${e}"`)).join(", ")}})}},v=({indices:e,reloadIndices:t})=>{if(!Object(x.every)(e,(e=>e.ilm&&e.ilm.managed)))return null;const n=e.map((({name:e})=>e));return{renderConfirmModal:e=>Object(j.jsx)(remove_lifecycle_confirm_modal_RemoveLifecyclePolicyConfirmModal,{indexNames:n,closeModal:e,reloadIndices:t}),icon:"stopFilled",indexNames:[n],buttonLabel:o.i18n.translate("xpack.indexLifecycleMgmt.removeIndexLifecycleActionButtonLabel",{defaultMessage:"Remove lifecycle policy"})}},P=({indices:e,reloadIndices:t,getUrlForApp:n})=>{if(1!==e.length)return null;const i=e[0];if(i.ilm&&i.ilm.managed)return null;const a=i.name;return{renderConfirmModal:e=>Object(j.jsx)(add_lifecycle_confirm_modal_AddLifecyclePolicyConfirmModal,{indexName:a,closeModal:e,index:i,reloadIndices:t,getUrlForApp:n}),icon:"plusInCircle",buttonLabel:o.i18n.translate("xpack.indexLifecycleMgmt.addLifecyclePolicyActionButtonLabel",{defaultMessage:"Add lifecycle policy"})}},k=e=>{const{Query:t}=g.EuiSearchBar;if(!e.length)return null;const n=e.filter((e=>"ERROR"===Object(x.get)(e,"ilm.step"))).length;return n?{type:"warning",filter:t.parse("ilm.step:ERROR"),filterLabel:o.i18n.translate("xpack.indexLifecycleMgmt.indexMgmtBanner.filterLabel",{defaultMessage:"Show errors"}),title:o.i18n.translate("xpack.indexLifecycleMgmt.indexMgmtBanner.errorMessage",{defaultMessage:"{ numIndicesWithLifecycleErrors, number}\n          {numIndicesWithLifecycleErrors, plural, one {index has} other {indices have} }\n          lifecycle errors",values:{numIndicesWithLifecycleErrors:n}})}:null},E=(e,t)=>Object(j.jsx)(index_lifecycle_summary_IndexLifecycleSummary,{index:e,getUrlForApp:t}),T=e=>Object(x.some)(e,(e=>e.ilm&&e.ilm.managed))?[{type:"field_value_selection",name:o.i18n.translate("xpack.indexLifecycleMgmt.indexMgmtFilter.lifecycleStatusLabel",{defaultMessage:"Lifecycle status"}),multiSelect:!1,field:"ilm.managed",options:[{value:!0,view:o.i18n.translate("xpack.indexLifecycleMgmt.indexMgmtFilter.managedLabel",{defaultMessage:"Managed"})},{value:!1,view:o.i18n.translate("xpack.indexLifecycleMgmt.indexMgmtFilter.unmanagedLabel",{defaultMessage:"Unmanaged"})}]},{type:"field_value_selection",field:"ilm.phase",name:o.i18n.translate("xpack.indexLifecycleMgmt.indexMgmtFilter.lifecyclePhaseLabel",{defaultMessage:"Lifecycle phase"}),multiSelect:"or",options:[{value:"hot",view:o.i18n.translate("xpack.indexLifecycleMgmt.indexMgmtFilter.hotLabel",{defaultMessage:"Hot"})},{value:"warm",view:o.i18n.translate("xpack.indexLifecycleMgmt.indexMgmtFilter.warmLabel",{defaultMessage:"Warm"})},{value:"frozen",view:o.i18n.translate("xpack.indexLifecycleMgmt.indexMgmtFilter.frozenLabel",{defaultMessage:"Frozen"})},{value:"cold",view:o.i18n.translate("xpack.indexLifecycleMgmt.indexMgmtFilter.coldLabel",{defaultMessage:"Cold"})},{value:"delete",view:o.i18n.translate("xpack.indexLifecycleMgmt.indexMgmtFilter.deleteLabel",{defaultMessage:"Delete"})}]}]:[],w="ILM_LOCATOR_ID";class locator_IlmLocatorDefinition{constructor(e){a()(this,"id",w),a()(this,"getLocation",(async e=>{const t=await this.deps.managementAppLocator.getLocation({sectionId:"data",appId:s.b.ID});switch(e.page){case"policy_create":return{...t,path:t.path+Object(_.d)()};case"policy_edit":return{...t,path:t.path+Object(_.e)(e.policyName)};case"policies_list":return{...t,path:t.path+Object(_.c)()}}})),this.deps=e}}class plugin_IndexLifecycleManagementPlugin{constructor(e){a()(this,"breadcrumbService",new breadcrumbs_BreadcrumbService),this.initializerContext=e}setup(e,t){const{ui:{enabled:i}}=this.initializerContext.config.get();if(i){const{http:i,notifications:{toasts:f},fatalErrors:m,getStartServices:p}=e,{usageCollection:x,management:g,indexManagement:y,home:b,cloud:h}=t;Object(l.a)(i),Object(d.b)(x),Object(u.b)(f,m),g.sections.section.data.registerApp({id:s.b.ID,title:s.b.TITLE,order:2,mount:async({element:e,history:t,setBreadcrumbs:i,theme$:a})=>{const[o,{licensing:r}]=await p(),{chrome:{docTitle:l},i18n:{Context:d},application:u,docLinks:f}=o,m=await r.license$.pipe(Object(c.first)()).toPromise();l.change(s.b.TITLE),this.breadcrumbService.setup(i);const{renderApp:x}=await n.e(1).then(n.bind(null,78)),g=x(e,d,t,u,this.breadcrumbService,m,a,f,h);return()=>{l.reset(),g()}}}),b&&b.featureCatalogue.register({id:s.b.ID,title:o.i18n.translate("xpack.indexLifecycleMgmt.featureCatalogueTitle",{defaultMessage:"Manage index lifecycles"}),description:o.i18n.translate("xpack.indexLifecycleMgmt.featureCatalogueDescription",{defaultMessage:"Define lifecycle policies to automatically perform operations as an index ages."}),icon:"indexRollupApp",path:"/app/management/data/index_lifecycle_management",showOnHomePage:!0,category:r.FeatureCatalogueCategory.ADMIN,order:640}),y&&((a=y.extensionsService).addAction(L),a.addAction(v),a.addAction(P),a.addBanner(k),a.addSummary(E),a.addFilter(T)),t.share.url.locators.create(new locator_IlmLocatorDefinition({managementAppLocator:t.management.locator}))}var a}start(){}stop(){}}const C=e=>new plugin_IndexLifecycleManagementPlugin(e)},function(e,t,n){n.r(t);var i=__kbnBundles__.get("plugin/esUiShared/static/forms/hook_form_lib");Object.defineProperties(t,Object.getOwnPropertyDescriptors(i))},function(e,t,n){n.r(t);var i=__kbnBundles__.get("plugin/esUiShared/static/forms/components");Object.defineProperties(t,Object.getOwnPropertyDescriptors(i))},function(e,t,n){n.r(t);var i=__kbnBundles__.get("plugin/kibanaReact/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(i))},function(e,t){e.exports=__kbnSharedDeps__.ReactRouterDom},function(e,t,n){n.r(t);var i=__kbnBundles__.get("plugin/esUiShared/static/forms/helpers");Object.defineProperties(t,Object.getOwnPropertyDescriptors(i))},function(e,t,n){n.r(t);var i=__kbnBundles__.get("entry/core/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(i))},function(e,t){e.exports=__kbnSharedDeps__.Moment},function(e,t){e.exports=__kbnSharedDeps__.ReactDom}]);