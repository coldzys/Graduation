!function(e){function t(t){for(var n,i,s=t[0],o=t[1],a=0,c=[];a<s.length;a++)i=s[a],Object.prototype.hasOwnProperty.call(r,i)&&r[i]&&c.push(r[i][0]),r[i]=0;for(n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n]);for(u&&u(t);c.length;)c.shift()()}var n={},r={3:0};function i(t){if(n[t])return n[t].exports;var r=n[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,i),r.l=!0,r.exports}i.e=function(e){var t=[],n=r[e];if(0!==n)if(n)t.push(n[2]);else{var s=new Promise((function(t,i){n=r[e]=[t,i]}));t.push(n[2]=s);var o,a=document.createElement("script");a.charset="utf-8",a.timeout=120,i.nc&&a.setAttribute("nonce",i.nc),a.src=function(e){return i.p+"visTypeTimeseries.chunk."+e+".js"}(e);var u=new Error;o=function(t){a.onerror=a.onload=null,clearTimeout(c);var n=r[e];if(0!==n){if(n){var i=t&&("load"===t.type?"missing":t.type),s=t&&t.target&&t.target.src;u.message="Loading chunk "+e+" failed.\n("+i+": "+s+")",u.name="ChunkLoadError",u.type=i,u.request=s,n[1](u)}r[e]=void 0}};var c=setTimeout((function(){o({type:"timeout",target:a})}),12e4);a.onerror=a.onload=o,document.head.appendChild(a)}return Promise.all(t)},i.m=e,i.c=n,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)i.d(n,r,function(t){return e[t]}.bind(null,r));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i.oe=function(e){throw console.error(e),e};var s=window.visTypeTimeseries_bundle_jsonpfunction=window.visTypeTimeseries_bundle_jsonpfunction||[],o=s.push.bind(s);s.push=t,s=s.slice();for(var a=0;a<s.length;a++)t(s[a]);var u=o;i(i.s=25)}([function(e,t,n){"use strict";n.d(t,"g",(function(){return i})),n.d(t,"n",(function(){return s})),n.d(t,"e",(function(){return o})),n.d(t,"l",(function(){return a})),n.d(t,"b",(function(){return u})),n.d(t,"i",(function(){return c})),n.d(t,"c",(function(){return d})),n.d(t,"j",(function(){return l})),n.d(t,"d",(function(){return p})),n.d(t,"k",(function(){return _})),n.d(t,"f",(function(){return f})),n.d(t,"m",(function(){return b})),n.d(t,"a",(function(){return m})),n.d(t,"h",(function(){return g}));var r=n(2);const[i,s]=Object(r.createGetterSetter)("UISettings"),[o,a]=Object(r.createGetterSetter)("FieldFormats"),[u,c]=Object(r.createGetterSetter)("CoreStart"),[d,l]=Object(r.createGetterSetter)("DataStart"),[p,_]=Object(r.createGetterSetter)("dataViews"),[f,b]=Object(r.createGetterSetter)("I18n"),[m,g]=Object(r.createGetterSetter)("ChartsPluginStart")},function(e,t){e.exports=__kbnSharedDeps__.EmotionReact},function(e,t,n){n.r(t);var r=__kbnBundles__.get("plugin/kibanaUtils/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(r))},function(e,t,n){"use strict";let r,i,s,o,a;n.d(t,"e",(function(){return r})),n.d(t,"c",(function(){return i})),n.d(t,"i",(function(){return s})),n.d(t,"a",(function(){return o})),n.d(t,"f",(function(){return a})),n.d(t,"g",(function(){return u})),n.d(t,"d",(function(){return c})),n.d(t,"h",(function(){return d})),n.d(t,"b",(function(){return l})),function(e){e.TABLE="table",e.GAUGE="gauge",e.MARKDOWN="markdown",e.TOP_N="top_n",e.TIMESERIES="timeseries",e.METRIC="metric"}(r||(r={})),function(e){e.UNWEIGHTED="simple",e.WEIGHTED_EXPONENTIAL="ewma",e.WEIGHTED_EXPONENTIAL_DOUBLE="holt",e.WEIGHTED_EXPONENTIAL_TRIPLE="holt_winters",e.WEIGHTED_LINEAR="linear"}(i||(i={})),function(e){e.FILTER_RATIO="filter_ratio",e.POSITIVE_RATE="positive_rate",e.PERCENTILE="percentile",e.PERCENTILE_RANK="percentile_rank",e.STATIC="static",e.STD_DEVIATION="std_deviation",e.SUM_OF_SQUARES="sum_of_squares",e.TOP_HIT="top_hit",e.VALUE_COUNT="value_count",e.VARIANCE="variance",e.CALCULATION="calculation",e.MOVING_AVERAGE="moving_average",e.POSITIVE_ONLY="positive_only",e.STD_DEVIATION_BUCKET="std_deviation_bucket",e.SUM_OF_SQUARES_BUCKET="sum_of_squares_bucket",e.VARIANCE_BUCKET="variance_bucket",e.SERIES_AGG="series_agg",e.MATH="math"}(s||(s={})),function(e){e.TERMS="terms",e.FILTERS="filters"}(o||(o={})),function(e){e.ENTIRE_TIME_RANGE="entire_time_range",e.LAST_VALUE="last_value"}(a||(a={}));const u="time_range_mode";let c,d,l;!function(e){e.GRADIENT="gradient",e.RAINBOW="rainbow"}(c||(c={})),function(e){e.SHOW_ALL="show_all",e.SHOW_FOCUSED="show_focused"}(d||(d={})),function(e){e.BYTES="bytes",e.CUSTOM="custom",e.DEFAULT="default",e.DURATION="duration",e.NUMBER="number",e.PERCENT="percent"}(l||(l={}))},function(e,t){e.exports=__kbnSharedDeps__.React},function(e,t){e.exports=__kbnSharedDeps__.ReactDom},function(e,t,n){n.r(t);var r=__kbnBundles__.get("plugin/visualizations/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(r))},function(e,t){e.exports=__kbnSharedDeps__.KbnI18n},function(e,t,n){"use strict";n.d(t,"e",(function(){return r})),n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return o})),n.d(t,"f",(function(){return a})),n.d(t,"d",(function(){return u}));const r={MAX_BUCKETS_SETTING:"metrics:max_buckets",ALLOW_STRING_INDICES:"metrics:allowStringIndices",ALLOW_CHECKING_FOR_FAILED_SHARDS:"metrics:allowCheckingForFailedShards"},i="╰┄►",s="auto",o={VIS_DATA:"/api/metrics/vis/data",FIELDS:"/api/metrics/fields"},a="use_kibana_indexes",u="#68BC00"},function(e,t){e.exports=__kbnSharedDeps__.Lodash},function(e,t,n){n.r(t);var r=__kbnBundles__.get("plugin/kibanaReact/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(r))},function(e,t,n){var r=n(23),i=n(24);e.exports=function(e,t,n){var s=t&&n||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var o=(e=e||{}).random||(e.rng||r)();if(o[6]=15&o[6]|64,o[8]=63&o[8]|128,t)for(var a=0;a<16;++a)t[s+a]=o[a];return t||i(o)}},function(e,t,n){"use strict";n.d(t,"d",(function(){return i})),n.d(t,"c",(function(){return s})),n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return a}));var r=n(9);const i=e=>"string"==typeof e,s=e=>{var t;return i(e)?e:null!==(t=null==e?void 0:e.id)&&void 0!==t?t:""},o=(e,t)=>{const n=[],i=e=>{e?n.push(e):t&&n.push({id:t})};return i(e.index_pattern),e.series.forEach((e=>{e.override_index_pattern&&i(e.series_index_pattern)})),e.annotations&&e.annotations.forEach((e=>i(e.index_pattern))),Object(r.uniq)(n).sort()},a=async(e,t,n={fetchKibanaIndexForStringIndexes:!1})=>{var r,s;let o,a="";return e?i(e)?(n.fetchKibanaIndexForStringIndexes&&(o=(await t.find(e)).find((t=>t.title===e))),o||(a=e),a=e):e.id&&(o=await t.get(e.id)):o=await t.getDefault(),{indexPattern:o,indexPatternString:null!==(r=null===(s=o)||void 0===s?void 0:s.title)&&void 0!==r?r:a}}},function(e,t){e.exports=__kbnSharedDeps__.MomentTimezone},function(e,t,n){n.r(t);var r=__kbnBundles__.get("plugin/expressions/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(r))},function(e,t){e.exports=__kbnSharedDeps__.ElasticEui},function(e,t){e.exports=__kbnSharedDeps__.KbnI18nReact},function(e,t,n){e.exports=n(22)(2)},function(e,t,n){n.r(t);var r=__kbnBundles__.get("plugin/data/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(r))},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(3);const i=e=>e.type===r.e.TABLE},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(13),i=n.n(r);function s(e){if(e.isDefault("dateFormat:tz")){return i.a.tz.guess()||i()().format("Z")}return e.get("dateFormat:tz","Browser")}},function(e,t,n){n.r(t);var r=__kbnBundles__.get("plugin/inspector/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(r))},function(e,t){e.exports=__kbnSharedDeps_npm__},function(e,t){var n="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(n){var r=new Uint8Array(16);e.exports=function(){return n(r),r}}else{var i=new Array(16);e.exports=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),i[t]=e>>>((3&t)<<3)&255;return i}}},function(e,t){for(var n=[],r=0;r<256;++r)n[r]=(r+256).toString(16).substr(1);e.exports=function(e,t){var r=t||0,i=n;return[i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]]].join("")}},function(e,t,n){n(26),__kbnBundles__.define("plugin/visTypeTimeseries/public",n,27)},function(e,t,n){n.p=window.__kbnPublicPath__.visTypeTimeseries},function(e,t,n){"use strict";n.r(t),n.d(t,"plugin",(function(){return P}));var r=n(17),i=n.n(r),s=n(4),o=n(5),a=n(0),u=n(15),c=n(1);const d=Object(s.lazy)((()=>Promise.all([n.e(0),n.e(1),n.e(4)]).then(n.bind(null,190)))),l=e=>Object(c.jsx)(s.Suspense,{fallback:Object(c.jsx)(u.EuiLoadingSpinner,null)},Object(c.jsx)(d,e));var p=n(10);const _="tsvbEditor";class editor_controller_EditorController{constructor(e,t,n,r){this.el=e,this.vis=t,this.eventEmitter=n,this.embeddableHandler=r}async render({timeRange:e,uiState:t,filters:n,query:r}){const i=Object(a.f)().Context,s=await Object(a.d)().getDefault()||void 0;Object(o.render)(Object(c.jsx)(i,null,Object(c.jsx)(p.KibanaThemeProvider,{theme$:Object(a.b)().theme.theme$},Object(c.jsx)(l,{config:Object(a.g)(),vis:this.vis,timeRange:e,embeddableHandler:this.embeddableHandler,eventEmitter:this.eventEmitter,uiState:t,filters:n,query:r,defaultIndexPattern:s}))),this.el)}destroy(){Object(o.unmountComponentAtNode)(this.el)}}var f=n(7),b=n(20),m=n(8),g=n(18);const v=()=>({name:"tsvb",type:"render",inputTypes:["kibana_context","null"],help:f.i18n.translate("visTypeTimeseries.function.help",{defaultMessage:"TSVB visualization"}),args:{params:{types:["string"],default:'"{}"',help:""},uiState:{types:["string"],default:'"{}"',help:""}},async fn(e,t,{getSearchSessionId:n,isSyncColorsEnabled:r,getExecutionContext:i,inspectorAdapters:s,abortSignal:o}){var u;const c=JSON.parse(t.params),d=JSON.parse(t.uiState),l=null!==(u=null==r?void 0:r())&&void 0!==u&&u,p=await(async({input:e,uiState:t,visParams:n,searchSessionId:r,executionContext:i,inspectorAdapters:s,expressionAbortSignal:o})=>{if(!o.aborted){var u;const d=Object(a.g)(),l=Object(a.c)(),p=Object(a.b)().theme,_=new AbortController,f=function(){_.abort()};o.addEventListener("abort",f);const v=Object(b.a)(d),O=null!==(u=t[n.type])&&void 0!==u?u:{},h=l.search,S=l.query.timefilter.timefilter.calculateBounds(null==e?void 0:e.timeRange);if(n&&n.id&&!n.isModelInvalid&&!o.aborted){const t=h.session.isCurrentSession(r)&&h.session.trackSearch({abort:()=>_.abort()});try{var c;const u=h.session.getSearchOptions(r),l=await Object(a.b)().http.post(m.b.VIS_DATA,{body:JSON.stringify({timerange:{timezone:v,...S},query:null==e?void 0:e.query,filters:null==e?void 0:e.filters,panels:[n],state:O,...u&&{searchSession:u}}),context:i,signal:_.signal});return null==s||null===(c=s.requests)||void 0===c||c.reset(),Object.entries(l.trackedEsSearches||{}).forEach((([e,t])=>{var n,i;null==s||null===(n=s.requests)||void 0===n||n.start(null!==(i=t.label)&&void 0!==i?i:e,{searchSessionId:r}).json(t.body).ok({time:t.time}),t.response&&d.get(m.e.ALLOW_CHECKING_FOR_FAILED_SHARDS)&&Object(g.handleResponse)({body:t.body},{rawResponse:t.response},p)})),l}finally{t&&h.session.isCurrentSession(r)&&t(),o.removeEventListener("abort",f)}}}return{}})({input:e,visParams:c,uiState:d,searchSessionId:n(),executionContext:i(),inspectorAdapters:s,expressionAbortSignal:o});return{type:"render",as:"timeseries_vis",value:{visParams:c,visData:p,syncColors:l}}}});var O=n(11),h=n.n(O),S=n(3),E=n(12),y=n(14),j=n(6),T=n(21);const x={name:"metrics",title:f.i18n.translate("visTypeTimeseries.kbnVisTypes.metricsTitle",{defaultMessage:"TSVB"}),description:f.i18n.translate("visTypeTimeseries.kbnVisTypes.metricsDescription",{defaultMessage:"Perform advanced analysis of your time series data."}),icon:"visVisualBuilder",group:j.VisGroups.PROMOTED,visConfig:{defaults:{id:()=>h()(),type:S.e.TIMESERIES,series:[{id:()=>h()(),color:m.d,split_mode:"everything",palette:{type:"palette",name:"default"},metrics:[{id:()=>h()(),type:"count"}],separate_axis:0,axis_position:"right",formatter:"default",chart_type:"line",line_width:1,point_size:1,fill:.5,stacked:"none",override_index_pattern:0,series_drop_last_bucket:0}],time_field:"",index_pattern:"",use_kibana_indexes:!0,interval:"",axis_position:"left",axis_formatter:"number",axis_scale:"normal",show_legend:1,truncate_legend:1,max_lines_legend:1,show_grid:1,tooltip_mode:S.h.SHOW_ALL,drop_last_bucket:0}},setup:e=>async function(e){const t=Object(a.d)(),n=await t.getDefault();return n&&n.id&&!e.params.index_pattern?(e.params.index_pattern={id:n.id},e):e}((e=>{var t;const n=e=>{"function"==typeof(null==e?void 0:e.id)&&(e.id=e.id())};return n(e.params),null===(t=e.params.series)||void 0===t||t.forEach((e=>{var t;n(e),null===(t=e.metrics)||void 0===t||t.forEach((e=>n(e)))})),e})(e)),editorConfig:{editor:_},options:{showQueryBar:!0,showFilterBar:!0,showIndexSelection:!1},toExpressionAst:e=>{const t=Object(y.buildExpressionFunction)("tsvb",{params:JSON.stringify(e.params),uiState:JSON.stringify(e.uiState)});return Object(y.buildExpression)([t]).toAst()},getSupportedTriggers:e=>(null==e?void 0:e.type)===S.e.TIMESERIES?[j.VIS_EVENT_TO_TRIGGER.filter,j.VIS_EVENT_TO_TRIGGER.brush]:[],navigateToLens:async e=>{const{triggerTSVBtoLensConfiguration:t}=await n.e(12).then(n.bind(null,192));return e?await t(e):null},inspectorAdapters:()=>({requests:new T.RequestAdapter}),requiresSearch:!0,getUsedIndexPattern:async function(e){const t=Object(a.d)(),n=await t.getDefault(),r=[],i=Object(E.a)(e,null==n?void 0:n.id);return(await Promise.all(i.map((e=>async function(e,t){if(e)return Object(E.d)(e)?await t.find(e,1):e.id?[await t.get(e.id)]:void 0}(e,t))))).forEach((e=>e&&r.push(...e))),r}};var I=n(9),D=n(16),A=n(19);const w=Object(s.lazy)((()=>n.e(5).then(n.bind(null,193))));class plugin_MetricsPlugin{constructor(e){i()(this,"initializerContext",void 0),this.initializerContext=e}setup(e,{expressions:t,visualizations:r}){r.visEditorsRegistry.register(_,editor_controller_EditorController),t.registerFunction(v),t.registerRenderer((({uiSettings:e,theme:t})=>({name:"timeseries_vis",reuseDomNode:!0,render:async(r,i,s)=>{n.e(8).then(n.t.bind(null,189,7)),s.onDestroy((()=>{Object(o.unmountComponentAtNode)(r)}));const{visParams:a,visData:u,syncColors:d}=i,l=!((e,t)=>{if("type"in e){var n;const r=Object(A.a)(e)?e.series:null==e||null===(n=e[t.id])||void 0===n?void 0:n.series;return Boolean(null==r?void 0:r.length)}return!1})(u,a);Object(o.render)(Object(c.jsx)(D.I18nProvider,null,Object(c.jsx)(p.KibanaThemeProvider,{theme$:t.theme$},Object(c.jsx)(j.VisualizationContainer,{"data-test-subj":"timeseriesVis",handlers:s,showNoResult:l,error:Object(I.get)(u,[a.id,"error"])},Object(c.jsx)(w,{getConfig:e.get.bind(e),handlers:s,model:a,visData:u,syncColors:d,uiState:s.uiState})))),r,(()=>{s.done()}))}}))({uiSettings:e.uiSettings,theme:e.theme})),Object(a.n)(e.uiSettings),r.createBaseVisualization(x)}start(e,{data:t,charts:n,dataViews:r}){Object(a.h)(n),Object(a.m)(e.i18n),Object(a.l)(t.fieldFormats),Object(a.j)(t),Object(a.k)(r),Object(a.i)(e)}}function P(e){return new plugin_MetricsPlugin(e)}},function(e,t,n){n.r(t);var r=__kbnBundles__.get("plugin/data/common");Object.defineProperties(t,Object.getOwnPropertyDescriptors(r))},function(e,t){e.exports=__kbnSharedDeps__.Moment},function(e,t){e.exports=__kbnSharedDeps__.ElasticCharts},function(e,t){e.exports=__kbnSharedDeps__.Classnames},function(e,t){e.exports=__kbnSharedDeps__.RisonNode},function(e,t){e.exports=__kbnSharedDeps__.RxjsOperators},function(e,t){e.exports=__kbnSharedDeps__.TsLib},function(e,t){e.exports=__kbnSharedDeps__.KbnDatemath},function(e,t){e.exports=__kbnSharedDeps__.SaferLodashSet},function(e,t,n){n.r(t);var r=__kbnBundles__.get("plugin/fieldFormats/common");Object.defineProperties(t,Object.getOwnPropertyDescriptors(r))},function(e,t){e.exports=__kbnSharedDeps__.Rxjs},function(e,t,n){n.r(t);var r=__kbnBundles__.get("plugin/charts/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(r))},function(e,t,n){n.r(t);var r=__kbnBundles__.get("plugin/charts/common");Object.defineProperties(t,Object.getOwnPropertyDescriptors(r))}]);